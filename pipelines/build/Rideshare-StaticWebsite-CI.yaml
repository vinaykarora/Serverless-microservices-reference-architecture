trigger:
- main

variables:
  # Agent VM image name
  vmImageName: 'windows-latest'

  # Working Directory
  workingDirectory: '$(System.DefaultWorkingDirectory)/web/serverless-microservices-web'
  BROWSERSLIST_IGNORE_OLD_DATA: true

pool:
  name: Azure Pipelines

steps:
- script: |
   npm install && npm audit fix --force && npm i -D eslint@7.32.0
  workingDirectory: $(workingDirectory)
  displayName: 'Install Dependencies'

- script: |
   npm run build
  workingDirectory: $(workingDirectory) 
  displayName: 'Build the Project'

- task: CopyFiles@2
  displayName: 'Copy Files'
  inputs:
    SourceFolder: '$(workingDirectory)/dist'
    Contents: 'dist/**'
    TargetFolder: '$(Build.ArtifactStagingDirectory)'
    CleanTargetFolder: true

- task: PublishBuildArtifacts@1
  displayName: 'Publish Artifact: staticvueweb'
  inputs:
    ArtifactName: staticvueweb
